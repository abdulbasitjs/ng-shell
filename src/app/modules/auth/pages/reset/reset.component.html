<div app-loader [isLoading]="loaderService.getLoader() | async"></div>
<ng-container *ngIf="!isPasswordReset; else success">
  <section
    class="auth--form__section forgot"
    [class.loading]="loaderService.getLoader() | async"
  >
    <p class="auth--form__section--title">New Password</p>
    <p class="auth--form__section--description">Enter new password below</p>
    <form class="form" [formGroup]="resetForm">
      <div class="form__input password">
        <label class="password-label">Type your new password</label>
        <div
          class="icon-container pos-rel"
          [class.error]="
            !resetForm.get('password')?.valid &&
            resetForm.get('password')?.touched
          "
        >
          <i
            [shouldRemoveParent]="false"
            appSvg
            src="assets/svg/Password.svg"
          ></i>
          <input
            class="fw"
            type="password"
            placeholder="Enter your password"
            formControlName="password"
            [class.error-msg]="
              !resetForm.get('password')?.valid &&
              resetForm.get('password')?.touched
            "
          />
          <div
            class="pos-abs error-msg"
            *ngIf="
              !resetForm.get('password')?.valid &&
              resetForm.get('password')?.touched
            "
          >
            <p *ngIf="!resetForm.get('password')?.value">
              {{ UIMSG.PROVIDE_PASSWORD }}
            </p>
          </div>
        </div>
      </div>
      <div class="form__input password">
        <label class="password-label">Confirm password</label>
        <div
          class="icon-container pos-rel"
          [class.error]="
            !resetForm.get('cPassword')?.valid &&
            resetForm.get('cPassword')?.touched
          "
        >
          <i
            [shouldRemoveParent]="false"
            appSvg
            src="assets/svg/Password.svg"
          ></i>
          <input
            class="fw"
            type="password"
            placeholder="Confirm your password"
            formControlName="cPassword"
          />
          <div
            class="pos-abs error-msg"
            *ngIf="
              !resetForm.get('cPassword')?.valid &&
              resetForm.get('cPassword')?.touched
            "
          >
            <p *ngIf="!resetForm.get('cPassword')?.value">
              {{ UIMSG.PROVIDE_PASSWORD }}
            </p>
          </div>
          <div
            class="pos-abs error-msg"
            *ngIf="
              resetForm.get('cPassword')?.value &&
              resetForm.get('password')?.value !==
                resetForm.get('cPassword')?.value
            "
          >
            <p>
              {{ UIMSG.PASSWORD_NOT_MATCH }}
            </p>
          </div>
        </div>
      </div>
    </form>
    <div class="form__action">
      <app-button
        btnTitle="Confirm Password"
        width="100%"
        [isDisabled]="
          resetForm.invalid ||
          resetForm.get('password')?.value !==
            resetForm.get('cPassword')?.value ||
          (loaderService.getLoader() | async)
        "
        classes="button-primary button-lg"
        (clickHandler)="onResetPassword()"
        type="submit"
      ></app-button>
    </div>
  </section>
</ng-container>

<ng-template #success>
  <section class="auth--form__section forgot success">
    <p class="auth--form__section--title">New Password</p>
    <p class="auth--form__section--description">
      Your password has been successfully reset, <br />
      Please login with your new password.
    </p>
    <form class="center m-b-50">
      <i
        [shouldRemoveParent]="false"
        appSvg
        src="assets/svg/NewPasswordCreated.svg"
      ></i>
    </form>
    <div class="form__action">
      <app-button
        btnTitle="Back to Sign in"
        width="100%"
        classes="button-primary button-lg"
        (clickHandler)="gotoLogin()"
        type="submit"
      ></app-button>
    </div>
  </section>
</ng-template>
